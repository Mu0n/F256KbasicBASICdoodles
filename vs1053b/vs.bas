5     '	"BASIC doodle from Mu0n, written in Feb2025"10    '	"This is meant to play a scale in C major using the"15    '	"VS1053b chip onboard a F256K2 or F256Jr2"20    '	"You may skip the machine ID detection part"97    '	"------------------------"98    '	"--------Globals---------"99    '	"------------------------"100   green=0:'"approves sendind data to VS1053b"197   '	"------------------------"198   '	"----------Main----------"199   '	"------------------------"200   print "--Testing the VS1053b onboard MIDI Chip"210   print "--Finding out if you have a compatible machine..."220   hwdetect()260   if green=0270   input "Still want to carry on with the test? Y/N:",ans$280   if (ans$="Y")^(ans$="y")290   print "okay then."300   else 310   print "kbye. tkx."320   end 330   endif 340   endif 350   input "Enable the real time plugin to the chip? Y/N:",ans$360   if (ans$="Y")^(ans$="y")365   boostvsclock()370   vsplugin()380   print "Plugin sent."382   else 384   print "Plugin not sent. Trying right away"385   for i=1 to 50:read z: next386   endif 389   input "Enable all CODEC bits? Y/N:",ans$390   if (ans$="Y")^(ans$="y")391   encodec()392   print "Codec enabled."393   else 394   print "Codec left as is"395   endif 396   print "Playing the C major scale on MIDI channel 0"397   '	"------------------------"398   '	"-----Note Playing-------"399   '	"------------------------"400   for i=0 to 7410   read note420   print note," ";425   noteon(note)430   delay()435   noteoff(note)450   next 451   print 480   end 497   '	"------------------------"498   '	"---hardware detection---"499   '	"------------------------"500   proc hwdetect()510   mid=peek($D6A7)515   mid=mid&$3F:'"keep only relevant bits"518   print "Machine ID detected: ",mid520   if mid=$02530   print "F256Jr2 detected":green=1540   else 550   if mid=$11560   print "F256K2 detected":green=1570   else 580   print "Possible incompatible machine detected"590   endif 600   endif 610   endproc 797   '	"------------------------"798   '	"--------delay-----------"799   '	"------------------------"800   proc delay()810   for i=0 to 10000:next 820   endproc 847   '	"------------------------"848   '	"------Note On-----------"849   '	"------------------------"850   proc noteon(n)860   poke $DDB1,$90:poke $DDB1,n:poke $DDB1,$4F:'"chn,note,speed"870   endproc 897   '	"------------------------"898   '	"------Note Off----------"899   '	"------------------------"900   proc noteoff(n)910   poke $DDB1,$80:poke $DDB1,n:poke $DDB1,$5F:'"chn,note,speed"920   endproc 997   '	"------------------------"998   '	"Real Time MIDI enabling-"999   '	"------------------------"1000  proc vsplugin()1010  for j=1 to 31020  read ady,n1030  for k=1 to n1040  read valhi,vallo1050  writetosci(ady,valhi,vallo)1060  next 1070  next 1080  endproc 1197  '	"------------------------"1198  '	"--Write to SCI of VS----"1199  '	"------------------------"1200  proc writetosci(a,hv,lv)1210  poke $D701,a1220  poke $D702,lv1225  poke $D703,hv1230  poke $D700,11240  poke $D700,01270  endproc 1297  '	"------------------------"1298  '	"----Enable CODEC lines--"1299  '	"------------------------"1300  proc encodec()1310  poke $D620,$1F1320  poke $D621,$2A1330  poke $D622,$011340  delay()1350  endproc 1397  '	"------------------------"1398  '	"-----Boost VS clock-----"1399  '	"------------------------"1400  proc boostvsclock()1410  poke $D701,31420  poke $D702,$001425  poke $D703,$A01440  poke $D700,11450  poke $D700,01460  delay()1470  endproc 1999  '	"VS1053b data for realtime midi plugin mode enabling"2000  data $07,$01,$80,$50,$06,$14,$00,$30,$07,$15,$B0,$802001  data $34,$00,$00,$07,$92,$55,$3D,$00,$00,$24,$00,$30,$02,$95,$68,$902002  data $34,$00,$00,$30,$04,$95,$3D,$00,$00,$24,$29,$08,$4D,$40,$00,$302003  data $02,$00,$0A,$01,$00,$502999  '	"MIDI note data for playback"3000  data $30,$32,$34,$35,$37,$39,$3B,$3C